<!DOCTYPE html>
<html>
<head>
	<title>Simple Simon</title>
    <style>
    	body {
    		background-image: url('/img/ironthrone2.png');
    		background-size: 100%;
    		padding: none;
    	}
	    #holder {
			width: 400px;
			height: 400px;
			border-radius: 50%;
			margin-left: auto;
			margin-right: auto;
			margin-top: 5%;
			background-color: black;
			
		}
		.buttons {
			width: 200px;
			height: 200px;
			float: left;
			opacity: .6;

		}
		#b1 {
			background-image: url('/img/ramsay1.png');
			border-top-left-radius: 300px; 
		}
		#b2 {
			background-image: url('/img/motherofdragons200x200.png');
			border-top-right-radius: 300px;
		}
		#b3 {
			background-image: url('/img/jonsnow200x200.png');
			border-bottom-left-radius: 300px;
		}
		#b4 {
			background-image: url('/img/nightking200x200.png');
			border-bottom-right-radius: 300px;
		}
		
		button, select {

			height: 20px;
			width: 100px;
			position: relative;
			text-align: center;
			
		}
			
		.buttonstyle {
			margin-left: auto;
			margin-right: auto;
			color: white;
			text-align: center;
			

		}

		#buttonHolder {

			height: 40px;
			width: 100px;
		}
		#messageHolder {
			width: 100%;
			height: 100px;
			background-color: none;
		}
		h1 {
			padding: none;
			margin-top: none;
			margin-bottom: none;
			border: none;
		}
		.text-align {
			text-align: center;

		}
		.hideme {
			background-color: black;
		}



    </style>
</head>
<body>
	<div class="buttonstyle" id="messageHolder">
		<h1>Simple Simon</h1>
		
	</div>
	<div class="buttonstyle" id="buttonHolder">
		<select class="buttonstyle hideme" id="difficulty" type="number">
			<option>Pick a Difficulty</option>
			<option value="1">Easy</option>
			<option value=".75">Normal</option>
			<option value=".5">Tough</option>
			<option value=".3">Hard</option>
			<option value=".2">Really Hard</option>
		</select>
		<button class="buttonstyle hideme" id="start">Start</button>
	</div>
	<div id="holder">
		<div class="buttons" id="b1" data-value="1"></div>
		<div class="buttons" id="b2" data-value="2"></div>
		<div class="buttons" id="b3" data-value="3"></div>
		<div class="buttons" id="b4" data-value="4"></div>
	</div>


	<audio id="mysoundclip" preload="auto">
    	<source src="/sounds/robotBlipEdit3.mp3"></source>
	</audio>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
	<script type="text/javascript">
	    var solution = [];
        var buttons = $('.buttons');
        var i = 0;
        var score = 0;
		var audio = $("#mysoundclip")[0];
		var gameOver = [1,3,4,2];


        function randomNumber(amount) {
            var random = Math.floor(Math.random() * (amount) + 1);
            return random;
        }


        //// sequencer to generate solution flashes
        function sequenceGenerator(array, pace) {
            setTimeout(function (){
                array.forEach(function(element,i){
                    setTimeout(function(){
                    	audio.play();    
                        console.log("tis working");
                        $('#b' + array[i].toString()).animate({
                            'opacity' : 1
                        }, 500 * pace).animate({
                        	'opacity' : .6
                    		}, 500 * pace)
                    },1000 * (i * pace))
                });
            }, 1000);         
        };

        function startSequence() {
        	$("h1").animate({
        		"opacity" : 0
        	}, 500, function(){
        			$('h1').text("Winter is coming...")
        			$('.hideme').animate({
        				opacity: 0
        				})
        			}).animate({
        				"opacity" : 1
        				}, 500).animate({
        						"opacity" : 0
        						},1000, function(){
        							$('h1').text("The North Remembers")	
        							}).animate({
        								"opacity" : 1
        								}, 500). animate({
        									"opacity" : 0
        									}, 1000, function(){
        										$('h1').text("Score: 0")
        										}).animate({
        											"opacity" : 1
        											}, 1000, function(){
        												sequenceGenerator(solution, $('#difficulty').val());
        												})
        }



       	$('#start').click(function() {
        	solution = [];
        	i = 0;
        	score = 0;
        	solution.push(randomNumber(4));
        	console.log(solution);

       		startSequence();
        	// $("h1").animate({
        	// 	"opacity" : 0
        	// 	}, 500, function(){
        	// 			$('h1').text("Game will now commence.")
        	// 			$('.hideme').animate({
        	// 				opacity: 0
        	// 				})
        	// 			}).animate({
        	// 				"opacity" : 1
        	// 				}, 500).animate({
        	// 						"opacity" : 0
        	// 						},1000, function(){
        	// 							$('h1').text("Score: 0")	
        	// 							}).animate({
        	// 								"opacity" : 1
        	// 								}, 500, function(){
        	// 									sequenceGenerator(solution, $('#difficulty').val());
        	// 									});

    	});
    	



    	buttons.each(function() {
        	$(this).click(function() {
            	audio.play();
        		$('#b' + $(this).data('value').toString()).animate({
                            'opacity' : 1
                        }, 90).animate({
                        	'opacity' : .6
                    	}, 220);               

                if (solution[i] == $(this).data('value')) {
                    i ++;
                    score += (50 / $('#difficulty').val());
                    $('h1').text("Score: " + parseInt(score));
                    console.log("success.");
                    if (i == solution.length) {
                        solution.push(randomNumber(4));
                        i = 0;
                        console.log(solution);
                        sequenceGenerator(solution, $('#difficulty').val());
                    }
                } 	else {
                    sequenceGenerator(gameOver, .2);
                    i = 0;
                    solution = [];
                    console.log("failure.");
                    $('h1').text("Final Score: " + parseInt(score));
                	$("h1").animate({
        				"opacity" : 1
        				}, 500, function(){
        					$('.buttonstyle').animate({
        						"opacity" : 1
        					}, 500)
        				})
                	};
            });
        });
	</script>

</body>
</html>